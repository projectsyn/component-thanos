parameters:
  thanos:
    multi_instance: true
    namespace: syn-thanos
    createNamespace: true
    cluster_kubernetes_version: "1.18"
    jsonnetfile_parameters:
      kubernetes_version: ${thanos:cluster_kubernetes_version}
      distribution: ${facts:distribution}
      # Set this parameter if you wish to use a specific thanos-mixin
      # version.
      thanos_mixin_version: ''
      # Set this parameter if you wish to use a specific kube-thanos
      # version.
      kube_thanos_version: ''
    dashboards:
      enabled: false
      namespace: ${thanos:namespace}
    commonConfig:
      namespace: ${thanos:namespace}
      version: v0.18.0
      image: ${thanos:images:thanos:registry}/${thanos:images:thanos:image}:${thanos:images:thanos:tag}
      serviceMonitor: true
      objectStorageConfig:
        name: thanos-objectstorage
        key: thanos.yaml
      volumeClaimTemplate:
        spec:
          accessModes: [ReadWriteOnce]
          resources:
            requests:
              storage: 10Gi
    objectStorageConfig: {}
    query:
      enabled: true
      replicas: 2
      serviceType: ClusterIP
      replicaLabels:
        - prometheus_replica
        - rule_replica
    queryRbacProxy:
      serviceName: ${_instance}-auth
      enabled: false
      port: 8080
      redirectUri: https://${thanos:ingress:host}
    ingress:
      enabled: false
      serviceName: ${_instance}-auth
      servicePort: ${thanos:queryRbacProxy:port}
      annotations:
        cert-manager.io/cluster-issuer: letsencrypt-production
      secretName: ${_instance}-tls
      host: ""
    bucket:
      enabled: false
      replicas: 1
    store:
      enabled: false
      replicas: 2
      serviceType: ClusterIP
    receive:
      enabled: false
      replicaLabels: ${thanos:query:replicaLabels}
      replicas: 1
      replicationFactor: 1
    compactor:
      enabled: false
      replicas: 1
      deduplicationReplicaLabels: ${thanos:query:replicaLabels}
      retentionResolutionRaw: 30d
      retentionResolution5m: 90d
      retentionResolution1h: 1y
    images:
      thanos:
        registry: quay.io
        image: thanos/thanos
        tag: ${thanos:commonConfig:version}
      oauthProxy:
        # There's also the same image available in the internal registry `image-registry.openshift-image-registry.svc:5000`.
        # Supported tags can be retrieved with `oc -n openshift get imagestream oauth-proxy`.
        registry: quay.io
        # Source: https://quay.io/repository/openshift/origin-oauth-proxy (which is indeed from https://github.com/openshift/oauth-proxy)
        image: openshift/origin-oauth-proxy
        tag: '4.9'
